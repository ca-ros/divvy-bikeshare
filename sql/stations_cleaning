-- Import csv files

-- missing_stations.csv
-- Import
COPY bike_trips.stations (
  id, 
  name, 
  docks, 
  latitude, 
  longitude, 
  coordinate)
FROM 'D:/Github/divvy-bikeshare/csv files/stations/missing_stations.csv'
DELIMITER ',' CSV HEADER;

-- id_changes_stations.csv
-- Create table
CREATE TABLE bike_trips.id_changes_stations (
  old_name varchar,
  new_id bigint);
-- Import
COPY bike_trips.id_changes_stations (old_name, new_id)
FROM 'D:/Github/divvy-bikeshare/csv files/stations/id_changes_stations.csv'
DELIMITER ',' CSV HEADER;

-- ID change
UPDATE bike_trips.stations as s
SET id = c.new_id
FROM bike_trips.id_changes_stations as c
WHERE s.name = c.old_name;